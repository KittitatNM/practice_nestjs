receivers:
  otlp:
    protocols:
      grpc:
        include_metadata: true
      http:
        cors:
          allowed_origins:
            - '*'
          allowed_headers:
            - '*'
        include_metadata: true
  zipkin:
  prometheus:
    config:
      scrape_configs:
        - job_name: cat
          scrape_interval: 5s
          static_configs:
            - targets: [192.168.1.5:9464]

processors:
  batch:
  # attributes:
  #   actions:
  #     - key: seq
  #       action: delete # remove sensitive element
exporters:
  zipkin:
    endpoint: 'http://localhost:9411/api/v2/spans'
  logging:
    loglevel: debug
  prometheus:
    endpoint: '0.0.0.0:8089' # this is weird because the exporter is actually an endpoint that must be scraped
  otlp/elastic:
    endpoint: 'http://apm-server:8200'
extensions:
  health_check:
  pprof:
  zpages:

service:
  extensions: [health_check, pprof, zpages]
  pipelines:
    traces:
      receivers: [otlp, zipkin]
      processors: [batch]
      exporters: [zipkin,otlp/elastic]

    metrics:
      receivers: [otlp,prometheus]
      processors: [batch]
      exporters: [prometheus,otlp/elastic]

    logs:
        receivers: [otlp]
        processors: [batch]
        # exporters: [zipkin]
        exporters: [otlp/elastic]